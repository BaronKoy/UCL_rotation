region <- factor(Table_data$Population, levels = unique(Table_data$Population))
Significance <- (Table_data$log10pvalue < Table_data$five_percent)
ggplot(Table_data, aes(x=region, y=log10pvalue, fill=Continent, width = 1)) + geom_violin() + stat_summary(fun = mean, geom = 'point', shape = 3, size =8, color = 'red') + stat_summary(fun = median, geom = 'point', shape = 3, size = 8, color = 'blue') + theme_grey() + theme(axis.text.x = element_text(angle = 70, vjust = 1, hjust=1)) + labs(title = 'TRPV1', y = '-log10pvalue', x = 'Population') + scale_y_reverse() + geom_point(aes(color = Significance), size = 2) + scale_color_manual(values = c('black', 'red'), labels = c('< 5%', '> 5%')) + theme(axis.text = element_text(size = 15), axis.title = element_text(size = 15)) + ylim(1, -6)

ggplot(TRPV1_manhattan, aes(x=Location, y=log10pvalue, color = Continent)) + theme_bw() + geom_text(data = subset(TRPV1_manhattan, log10pvalue < -2.5), fontface = 'bold', aes(label = RS_ID), size = 5, position = position_jitter(width = NULL, height = 0.25)) + theme(axis.text.x = element_text(angle = 70, vjust = 1, hjust=1)) + labs(title = 'TRPV1', y = '-log10pvalue', x = 'Chromosome 17 TRPV1(356544-3609411)') + scale_y_reverse() + geom_point(size = 3) + theme(axis.text = element_text(size = 11), axis.title = element_text(size = 11)) + coord_cartesian(xlim = c(3562291, 3612660), ylim = c(0, -6), expand = FALSE)

ggplot(gene_summary, aes(x = GeneSizebp, y = Variation_percent)) + geom_point(color = 'steelblue', size = 2.5) + geom_text(aes(label = Gene), size = 3, vjust = -1) + labs(title = 'Gene size (bp) vs total variant count', x = 'Gene size (bp)', y = '% of gene variation') + scale_y_continuous(limits = c(0,50), labels = scales::percent) + theme_grey()